# Always scale activities to number required by the activities scheduled
ActivitiesWaiting:
  AlarmActions:
    - Ref: ScaleOutTasksECSServiceApplicationScalingPolicy
  OKActions:
    - Ref: ScaleInTasksECSServiceApplicationScalingPolicy
  TreatMissingData: notBreaching
  ComparisonOperator: GreaterThanThreshold
  EvaluationPeriods: 1
  Threshold: 0
  Metrics:
    - Id: e1
      Expression: m2 - m1
      Label: HelloWorldActivitiesWaiting
    - Id: m2
      MetricStat:
        Metric:
          Namespace: AWS/States
          MetricName: ActivitiesScheduled
          Dimensions:
            - Name: ActivityArn
              Value:
                Ref: HelloWorldActivity
        Period: 60
        Stat: Sum
        Unit: Count
      ReturnData: false
    - Id: m1
      MetricStat:
        Metric:
          Namespace: AWS/States
          MetricName: ActivitiesStarted
          Dimensions:
            - Name: ActivityArn
              Value:
                Ref: HelloWorldActivity
        Period: 60
        Stat: Sum
        Unit: Count
      ReturnData: false
