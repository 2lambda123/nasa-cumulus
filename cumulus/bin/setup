#!/bin/bash

set -e

version=v0.0.1
progname=$(basename $0)
docstr="$progname $version: Installs dependencies"

usage() {
echo "Usage:
  $progname

Examples:
  $progname
"
}

function echoerr() {
    echo "Error: $@" 1>&2;
}

if [ $# -ne 0 ]; then
    echo "$docstr"
    echo
    usage
    exit 1
fi

if [ -f ../bin/setup ] && [ ! -d .git ]; then
    echo "(Using parent setup script)"
    cd ..
    bin/setup
else
    find . -name package.json \
         -not -path './test/*' \
         -not -path '*/node_modules/*' \
         -not -path './package.json' \
         -execdir npm install --unsafe-perm \;

    npm install
fi
