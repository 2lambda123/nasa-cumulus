HelloWorldWorkflow:
  Comment: 'Returns Hello World'
  StartAt: HelloWorld
  States:
    HelloWorld:
      CumulusConfig:
        buckets: '{$.meta.buckets}'
        provider: '{$.meta.provider}'
        collection: '{$.meta.collection}'
      Type: Task
      Resource: ${HelloWorldLambdaFunction.Arn}
      Retry:
        - &LambdaServiceExceptionRetry
          ErrorEquals:
          - Lambda.ServiceException
          - Lambda.AWSLambdaException
          - Lambda.SdkClientException
          IntervalSeconds: 2
          MaxAttempts: 6
          BackoffRate: 2
      Next: WorkflowSucceeded
    WorkflowSucceeded:
      Type: Succeed

EcsHelloWorldWorkflow:
  Comment: 'Returns Hello World'
  StartAt: EcsTaskHelloWorld
  States:
    EcsTaskHelloWorld:
      CumulusConfig:
        buckets: '{$.meta.buckets}'
        provider: '{$.meta.provider}'
        collection: '{$.meta.collection}'
      Type: Task
      Resource: ${EcsTaskHelloWorldActivity}
      TimeoutSeconds: 60
      Retry:
        - ErrorEquals:
            - States.Timeout
          MaxAttempts: 1
      Catch:
        - ErrorEquals:
          - States.ALL
          Next: WorkflowFailed
      Next: WorkflowSucceeded
    WorkflowSucceeded:
      Type: Succeed
    WorkflowFailed:
      Type: Fail
      Cause: 'Workflow failed'


EcsKesCMAHelloWorldWorkflow:
  Comment: 'Returns Hello World'
  StartAt: EcsTaskHelloWorld
  States:
    EcsTaskHelloWorld:
      CumulusConfig:
        buckets: '{$.meta.buckets}'
        provider: '{$.meta.provider}'
        collection: '{$.meta.collection}'
      Type: Task
      Resource: ${EcsTaskHelloWorldKesCmaActivity}
      TimeoutSeconds: 60
      Retry:
        - ErrorEquals:
            - States.Timeout
          MaxAttempts: 1
      Catch:
        - ErrorEquals:
          - States.ALL
          Next: WorkflowFailed
      Next: WorkflowSucceeded
    WorkflowSucceeded:
      Type: Succeed
    WorkflowFailed:
      Type: Fail
      Cause: 'Workflow failed'
